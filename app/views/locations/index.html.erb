<div class="row">
  <div class="small-12 large-12 large-centered columns panel huddles_framing">
    <h4>Locations</h4>

    <div id="map" style="height: 400px;"></div>
      <ul class="locations">

        <% @locations.each do |location| %>
          <%= render location %>
        <% end %>
      </ul>
  </div>
</div>

<div class="row">
<%- @locations.each do |location| -%>
  <div class="row panel huddles_framing">
    <div class= "small-12 large-6 columns left_align">
      <p>
        <strong>Court Name:</strong><br>
        <%= location.court_name %>
      </p>

      <p>
        <strong>City:</strong>
        <%= location.city %>
      </p>
      <p>
        <strong>State:</strong>
        <%= location.state %>
      </p>

      <!-- google maps location details -->
      <!-- Like the red baloons  -->
      <!-- Add Court Descriptions  -->
    </div>
    <div class="small-12 large-6 columns right_align">
      <%= image_tag "http://maps.google.com/maps/api/staticmap?size=400x250&sensor=false&zoom=14&markers=#{location.latitude}%2C#{location.longitude}" %>
    </div>
    <div class="row">
      <p>
        <%= link_to "More Info about #{location.court_name}", location, method: :get, class: "link" %>
      </p>
    </div>
  </div>
<%- end -%>
  <ol class="joyride-list" data-joyride>
    <li data-id="map" data-class="custom so-awesome" data-text="Next">
      <h4>Street View</h4>
      <p>Click and drag the icon under the compass to a location to enter street view.</p>
    </li>
    <li data-id="map" data-button="Next">
      <h4>Exit Street View</h4>
      <p>(In street view)Click the small grey square at the top right to exit street view.</p>
    </li>
    <li data-button="End">
      <h4>Go Huddle Up!</h4>
      <p>Go checkout your city's beautiful basketball courts.</p>
    </li>
  </ol>
</div>


<%= javascript_include_tag "application" %>

<% content_for :javascript do %>
    <script type="text/javascript"
      src="//maps.googleapis.com/maps/api/js?sensor=true"></script>

    <%= javascript_tag do %>
      $(function() {
        var mapper = new ExampleApp.Mapper('#map');

        $('[data-latitude]').each(function(index, element) {
          mapper.addCoordinates(
            $(element).attr('data-latitude'),
            $(element).attr('data-longitude')
          );
      });

      mapper.render();
    });
    <% end %>
<% end %>

<script>
    $(function() {
      if ($('#search_value').attr('placeholder').length > 0) {
        var currentLocation = new ExampleApp.CurrentLocation();

        currentLocation.getLocation(function(location) {
          $('#search_value').attr('placeholder', location);
        })
      }
    });

  $(document).foundation('joyride', 'start');
</script>
